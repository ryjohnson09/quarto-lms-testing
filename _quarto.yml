project:
  type: website
  resources:
    - _headers

website:
  title: "Quarto LMS Testing"
  navbar: false

format:
  html:
    toc: false
    code-fold: true
    css: styles.css
    include-after-body:
      - text: |
          <script>
          if (window.top === window.self) {
            document.body.innerHTML = '<div style="display:flex;justify-content:center;align-items:center;height:100vh;font-family:system-ui;color:#555;"><p>This content is available in the course portal.</p></div>';
          }
          </script>
          <script>
          const sendHeight = () => {
            window.parent.postMessage(
              { type: 'iframeResize', height: document.body.scrollHeight },
              '*'
            );
          };
          new ResizeObserver(sendHeight).observe(document.body);
          sendHeight();
          </script>
          <script>
          {
            const gated = document.querySelectorAll('.gated');
            if (gated.length > 0) {
              function createBtn(nextSection) {
                const btn = document.createElement('button');
                btn.className = 'continue-btn';
                btn.textContent = 'Continue';
                btn.addEventListener('click', () => {
                  nextSection.classList.add('unlocked');
                  btn.remove();
                  nextSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                  sendHeight();
                });
                return btn;
              }
              gated[0].parentNode.insertBefore(createBtn(gated[0]), gated[0]);
              for (let i = 0; i < gated.length - 1; i++) {
                gated[i].appendChild(createBtn(gated[i + 1]));
              }
            }
          }
          </script>
